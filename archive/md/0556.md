## 556: Re: [blupf90] single-step blup - disease trait - estimation problems

- Title: 556: Re: [blupf90] single-step blup - disease trait - estimation problems
- Author: Andres Legarra
- Date: Sep 18, 2015
```
 I have myself no experience in predictf90. Check output of predictf90 on screen and verify that -999 is considered as
missing. May be that predictf90 does not support -999 as missing. I would anyway try coding 0 as missing and then 1/2
as healthy/sick. 

 Andres

On 16/09/15 22:28, rama bangera rm_bangera@... [blupf90] wrote:

  Â DearÂ 
I am trying to run single step ssblup for a disease trait in fish 



Data : with 2750 animals (trait = binary 0/1) genotyped for ~ 50000 SNP, the trait analyzed as linear
datafiles: phenotypefile, genotypefille, mapfile and pedigreefile 



the sequence of run is as follows :
1. renumf90 

- here i divided the data (renf90.dat) such that - testdata.dat (have random 20% missing genotypesÂ  coded as -999),
and validationdata.dat (with all those 20% missing data from testdata.dat). 

- the testdata.dat used in pregsf90, airemlf90 and postgsf90. validationdata.dat used in predictf90 . The .par file
modified for each run. 

2. pregsf90 

important options used :
OPTION SNP_file genotypefile.txt
 OPTION chrinfo mapfile.txt


3. airemlf90 



important options used :
OPTION SNP_file genotypefile.txt
 OPTION conv_crit 1d-16
 OPTION chrinfo mapfile.txt
 OPTION missing -999



4. postgsf90


important options used:
OPTION SNP_file genotypefile.txt
 OPTION chrinfo mapfile.txt




5. predictf90 



important options used:


OPTION SNP_file genotypefile.txt
 OPTION chrinfo mapfile.txt
 OPTION include_effects 2
 OPTION missing -999



It runs properly until the option 1 to 4, but at the predictf90, I am getting wiered correlation, for example:


Trait:Â Â Â Â Â Â Â Â Â Â Â  1Â Â Â Â Â Â Â Â  549
 Â Â Â	mean YÂ Â Â Â Â Â Â Â  -999.389849998043Â Â Â Â Â Â  var YÂ Â Â Â Â Â Â Â Â  1.426782420951955E-002
 Â Â Â	mean YhatÂ Â Â Â  -9.018972706056467E-003Â  var YhatÂ Â Â Â Â Â  3.193376940400771E-003
 Â Â Â	cov (Y,Yhat)Â  -3.035603192877908E-004Â  corr (Y,Yhat) -4.497187900814020E-002
 Â wrote bvs for animals in data in file "bvs.dat"




also bvs.dat file is empty but there is another file bvs2.dat, without only one column with list of animals. The
yhat_residuals also looks awkward as:


Â Â Â Â  1347Â Â  -999.371033Â Â Â Â Â	0.000122Â Â  -999.000122
 Â Â Â Â Â Â  509Â Â  -999.539795Â Â Â Â Â  0.000061Â Â  -999.000061
 Â Â Â Â Â Â  938Â Â  -999.459167Â Â Â Â Â  0.000061Â Â  -999.000061
 Â Â Â Â Â Â  571Â Â  -999.530334Â Â Â Â Â  0.000183Â Â  -999.000183
 Â Â Â Â Â Â  500Â Â  -999.377136Â Â Â Â Â  0.000122Â Â  -999.000122
 Â Â Â Â Â Â  480Â Â  -999.272339Â Â Â Â Â  0.000122Â Â  -999.000122
 Â Â Â Â Â  2408Â Â  -999.459045Â Â Â Â Â  0.000061Â Â	-999.000061


I can see the values "y"Â  have that missing value -999. I have also tried with and withoutÂ  the OPTION missing -999
at the step predictf90. 



Please let me know what could be the problem?


Many thanks
Rama Bangera
Â 
RAMA BANGERA, Ph.D.Â  Jefe de DesarrolloÂ Genetico | Genetic Development Manager AquaInnovoÂ S.A.Â  Talca 60Â  Piso 4,
PuertoÂ Montt, Chile. Office: +56 652204321 | Cell : +56 967618183Â  rama.bangera@... | www.aquainnovo.com



-- 
Andres Legarra
+33 561285182
INRA, UR1388 GenPhySE SAGA
CS 52627
31326 Castanet Tolosan, France 
```

- [554](0554.md): single-step blup - disease trait - estimation problems by rama bangera, Sep 16, 2015
    - [556](0556.md): Re: [blupf90] single-step blup - disease trait - estimation problems by Andres Legarra, Sep 18, 2015
        - [557](0557.md): Re: [blupf90] single-step blup - disease trait - estimation problems by rama bangera, Sep 18, 2015
