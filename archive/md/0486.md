## 486: Re: [blupf90] Dominance effect on airemlf90

- Title: 486: Re: [blupf90] Dominance effect on airemlf90
- Author: Andres Legarra
- Date: Apr 16 11:55 PM
- Original: [https://groups.yahoo.com/neo/groups/blupf90/conversations/messages/486](https://groups.yahoo.com/neo/groups/blupf90/conversations/messages/486)

```
 Then I have not much hope, but try remlf90 instead

Le 16/04/2015 20:10, Vinicius Junqueira junqueiravinicius@... [blupf90] a Ã©critÂ :

  Â Andres,

The lowest eigenvalue of Dinv is 0.35. Iâ€™m still having the same pattern on variance of dominance (set to zero) and
deviance in running airemlf90.


I used user_file option.


-2logL =Â  Â  4434.11097020201 Â  Â  Â	: AIC =Â  Â  4442.11097020201Â	Â  Â 
Â  In roundÂ  Â  Â  Â  Â  Â  1Â  convergence= Â  1.74778582276675Â  Â  Â 
Â  delta convergence=Â	5.563226455375768E-002
Â new R
Â  0.60921E-01
Â new G
Â  0.10665E-01
Â new G
Â  0.10000E-09
Â new G
Â  0.68023E-01
Â -2logL =Â  Â	4324.98365260626 Â  Â  Â  : AIC =Â  Â  4332.98365260626Â  Â  Â 
Â  In roundÂ  Â  Â  Â  Â  Â  2Â  convergence=Â	0.781552538479617Â  Â  Â 
Â  delta convergence=Â	2.491001681574395E-002
Â new R
Â  0.63068E-01
Â new G
Â  0.10625E-01
Â new G
Â  0.10000E-09
Â new G
Â  0.45830E-01
Â -2logL =Â  Â	3986.24666033681 Â  Â  Â  : AIC =Â  Â  3994.24666033681Â  Â  Â 
Â  In roundÂ  Â  Â  Â  Â  Â  3Â  convergence= Â  6.23033806728107Â  Â  Â 
Â  delta convergence=Â	1.357508861346725E-002
Â new R
Â  0.64440E-01
Â new G
Â  0.15183E-01
Â new G
Â  0.10000E-09
Â new G
Â  0.40538E-02
Â -2logL =Â  Â	3780.36368022254 Â  Â  Â  : AIC =Â  Â  3788.36368022254Â  Â  Â 
Â  In roundÂ  Â  Â  Â  Â  Â  4Â  convergence=Â	0.307138202193162Â  Â  Â 
Â  delta convergence=Â	3.763747852786205E-003
Â new R
Â  0.65111E-01
Â new G
Â  0.12715E-01
Â new G
Â  0.10000E-09
Â new G
Â  0.14241E-01
Â -2logL =Â  Â	3696.72666739346 Â  Â  Â  : AIC =Â  Â  3704.72666739346Â  Â  Â 
Â  In roundÂ  Â  Â  Â  Â  Â  5Â  convergence=Â	4.380248013534999E-002
Â  delta convergence=Â	1.811628973441780E-003



Â [â€¦]


-2logL =Â  Â  3701.42378180510 Â  Â  Â	: AIC =Â  Â  3709.42378180510Â	Â  Â 
Â  In round Â  Â  Â  Â	Â  11Â	convergence=Â  1.868562947514228E-002
Â  delta convergence=Â	7.517804468625512E-004
Â new R
Â  0.64770E-01
Â new G
Â  0.12099E-01
Â new G
Â  0.10000E-09
Â new G
Â  0.18124E-01
Â -2logL =Â  Â	3701.42399000086 Â  Â  Â  : AIC =Â  Â  3709.42399000086Â  Â  Â 
Â  In round Â  Â  Â  Â	Â  12Â	convergence=Â  1.868510430371578E-002
Â  delta convergence=Â	7.517667386248016E-004
Â new R
Â  0.64770E-01
Â new G
Â  0.12099E-01
Â new G
Â  0.10000E-09
Â new G
Â  0.18124E-01
Â -2logL =Â  Â	3701.42380697506 Â  Â  Â  : AIC =Â  Â  3709.42380697506Â  Â  Â 
Â  In round Â  Â  Â  Â	Â  13Â	convergence=Â  1.868565086898704E-002
Â  delta convergence=Â	7.517798724843852E-004
Â new R
Â  0.64770E-01
Â new G
Â  0.12099E-01
Â new G
Â  0.10000E-09
Â new G
Â  0.18124E-01
Â -2logL =Â  Â	3701.42399443226 Â  Â  Â  : AIC =Â  Â  3709.42399443226Â  Â  Â 
Â  In round Â  Â  Â  Â	Â  14Â	convergence=Â  1.868543439643729E-002
Â  delta convergence=Â	7.517671434780311E-004
Â new R
Â  0.64770E-01
Â new G
Â  0.12099E-01
Â new G
Â  0.10000E-09
Â new G
Â  0.18124E-01
Â -2logL =Â  Â	3701.42390823604 Â  Â  Â  : AIC =Â  Â  3709.42390823604Â  Â  Â 
Â  In round Â  Â  Â  Â	Â  15Â	convergence=Â  1.868572173612804E-002
Â  delta convergence=Â	7.517742154780820E-004
Â new R
Â  0.64770E-01
Â new G
Â  0.12099E-01
Â new G
Â  0.10000E-09
Â new G
Â  0.18124E-01
Â -2logL =Â  Â	3701.42400585497 Â  Â  Â  : AIC =Â  Â  3709.42400585497Â  Â  Â 
Â  In round Â  Â  Â  Â	Â  16Â	convergence=Â  1.868545501143718E-002
Â  delta convergence=Â	7.517675872367582E-004
Â new R
Â  0.64770E-01
Â new G
Â  0.12099E-01
Â new G
Â  0.10000E-09
Â new G
Â  0.18124E-01


---
 VinÃ­cius Silva Junqueira
Ph.D Student in Genetics and Breeding | UFV
ViÃ§osa | Brazil
skype:Â junqueira.vinicius




Em 16/04/2015, Ã (s) 12:27, Andres Legarra Andres.Legarra@... [blupf90] <blupf90@yahoogroups.com> escreveu:

I bet for a numerical problem. I strongly recommend that instead of using the dominance matrix in "outfile", you invert
it with an external problem (e.g. "solve' in R) and check the eigenvalues. All should be positive,Â  and if not do
something like 0.99D+0.01 I . Then use the file with the inverted matrix and option user_file (not user_file_inv).

 Andres

Le 16/04/2015 17:22, Vinicius JunqueiraÂ junqueiravinicius@...Â [blupf90] a Ã©critÂ :

Sure, it goes attached!Â 


The trait is tick count transformed as log10(x + 1.0001)---
 VinÃ­cius Silva Junqueira
Ph.D Student in Genetics and Breeding | UFV
ViÃ§osa | Brazil
skype:Â junqueira.vinicius




Em 16/04/2015, Ã (s) 12:12, Andres LegarraÂ Andres.Legarra@...Â [blupf90] <blupf90@yahoogroups.com> escreveu:

Then results are strange, I would hope 10-30% of total genetic variance as dominance variance. Can you put the par
file? What is the trait?

Le 16/04/2015 16:44, Vinicius JunqueiraÂ junqueiravinicius@...Â [blupf90] a Ã©critÂ :

Â Andres,

I forgot to say that I had included one effect on renf90.dat that relates phenotypes with dominance effects and the
coding used for was the same for additive (thats why I used _XrefID coding - from 1 to 3455). The level 1 on dominance
effect (in renf90.dat) is the same level on line 1 and column 1 (and so on) on my input file.


Andres, thanks for reply!!

---
 VinÃ­cius Silva Junqueira
Ph.D Student in Genetics and Breeding | UFV
ViÃ§osa | Brazil
skype:Â junqueira.vinicius




Em 16/04/2015, Ã (s) 10:08, Andres LegarraÂ Andres.Legarra@...Â [blupf90] <blupf90@yahoogroups.com> escreveu:

Vinicius,
 you are using user_file and so the coding of the dominant effect is (or can be) different from the coding of the
animal effect and the codes in X_refid. For blupf90, user_file can be just anything and does not know that these are
animals.
 You must code the dominant effects from 1 to 3455 and then put those values as an extra column in the data file. The
codes can be the same as for "animal" or they can be different.

 Andres

Le 16/04/2015 14:56, Vinicius JunqueiraÂ junqueiravinicius@...Â [blupf90] a Ã©critÂ :

Â Hi all,


Iâ€™m fitting an repeatability animal model inÂ airemlf90Â with additive and dominance random effects. Iâ€™m computing
dominance effects as ~ N(0,D*s2d), since D is being created as proposed by Vitezica et al. (2013). Dominance file
format follow as an example bellow in which first (i) and second (j) columns are recoded as animal id on
[snp_file_name]_XrefID file. Am I recoding dominance file wrong?


1 1Â  Â  1.0121500492
1 2Â  Â  0.0129484450
1 3Â  Â  0.0083033340
1 4 Â  -0.0017907361
1 5Â  Â  0.0124599356
1 6Â  Â  0.0113029769
1 7 Â  -0.0185306780
1 8 Â  -0.0305246934

[â€¦]


All phenotyped animals (3455) are genotyped. Sire and dam informations are missing, so, the second and third columns of
my pedigree file are zero in all levels.



When starting iterative process with different initial values (tested several times) it can be noted that variance of
dominance is going to zero and there is no significant difference on deviance between iterations. Any suggestions?


An example of iteration statistics is presented below.




Â -2logL = Â  Â 6761.29579438954 Â  Â  Â  : AIC = Â  Â 6769.29579438954 Â  Â Â 
Â Â In round Â	Â  Â  Â  Â  Â 1 Â convergence= Â  1.22180082494541 Â  Â Â 
Â Â delta convergence= Â 0.779505602068096 Â  Â Â 
Â new R
Â Â 0.60697E-01
Â new G
Â Â 0.61385E-01
Â new G
Â Â 0.10000E-09
Â new G
Â Â 0.77591 Â  Â 
Â -2logL = Â  Â 9904.73339517791 Â  Â  Â  : AIC = Â  Â 9912.73339517791 Â  Â Â 
Â Â In round Â	Â  Â  Â  Â  Â 2 Â convergence= Â 0.999996001761650 Â  Â Â 
Â Â delta convergence= Â  3.84438070903890 Â  Â Â 
Â new R
Â Â 0.62760E-01
Â new G
Â 
(Message over 64 KB, truncated) 
```

- [479](0479.md): Dominance effect on airemlf90 by Vinicius Junqueira, Apr 16 5:56 AM
    - [480](0480.md): Re: [blupf90] Dominance effect on airemlf90 by Andres Legarra, Apr 16 6:08 AM
        - [481](0481.md): Re: [blupf90] Dominance effect on airemlf90 by Vinicius Junqueira, Apr 16 7:44 AM
            - [482](0482.md): Re: [blupf90] Dominance effect on airemlf90 by Andres Legarra, Apr 16 8:12 AM
                - [483](0483.md): Re: [blupf90] Dominance effect on airemlf90 by Vinicius Junqueira, Apr 16 8:22 AM
                    - [484](0484.md): Re: [blupf90] Dominance effect on airemlf90 [1 Attachment] by Andres Legarra, Apr 16 8:27 AM
                        - [485](0485.md): Re: [blupf90] Dominance effect on airemlf90 by Vinicius Junqueira, Apr 16 11:10 AM
                            - [486](0486.md): Re: [blupf90] Dominance effect on airemlf90 by Andres Legarra, Apr 16 11:55 PM
                                - [489](0489.md): RE: [blupf90] Dominance effect on airemlf90 by Vinicius Junqueira, Apr 17 8:01 AM
