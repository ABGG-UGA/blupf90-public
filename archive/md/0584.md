## 584: Re: [blupf90] HBLUP with 10 traits

- Title: 584: Re: [blupf90] HBLUP with 10 traits
- Author: Andres Legarra
- Date: Nov 4, 2015

```
 Sebastian,
 a 10 trait analysis in blupf90 will set up the MME for 10 traits, which implies 10^2 copies of H^-1, so ~
100*(4461**2)/2 double precision coefficients, which is a lot of space.
 The first suggestion is to use a Linux server that will handle better. Also serious testing of these programs is
always done in linux machines.
 The second point is that for so many coefficients, perhaps the hash or address subroutines are not adequate, or are
not adequate in windows, or have some bugs. I would suggest using blupf90iod2 (iteration on data) for which you need to
contact Ignacy.

 Andres



On 04/11/15 17:32, sebmucha@... [blupf90] wrote:

Â Dear BLUPf90 team,
I have tried to run an analysis (single-step BLUP) with 10 traits in BLUPf90.I have 4461 genotyped animals,Â 35525
animals in the pedigree, andÂ 6716 records in the phenotype file.Each trait is modelled with the same animal model with
4 fixed effects and random animal effect.Everything works fine if I run the analysis with the first 5 traits or the
last 5 traits.I can also run it with 9 traits, but it crashes when I have all 10 traits (see LOG1).I am running this on
a 64bit Windows server with 256 GB of RAM.As far as I could see BLUPf90 (versionÂ 1.48)Â used around 78 GB or
RAM.Recently I tried running this analysis with an updated version of BLUPf90 (version 1.51).In this case it runs, but
I get NaN as solutions for convergence values and as solutions for all animals (see LOG2).I would like to add that this
analysis worked fine in the past when I had a smaller dataset with only 2500 genotyped animals, 5000 phenotyped
animals, and around 32000 animals in the pedigree.I will be grateful for your help and suggestions.

LOG1:*------------------------** Setup Genomic Done !!! **------------------------*
hash matrix increased from Â  Â  Â  Â 33554432 to Â  Â	Â  Â 67108864 % filled: Â  Â  0.8000hash matrix increased from
Â  Â  Â  Â 67108864 to Â  Â  Â	134217728 % filled: Â  Â  0.8000hash matrix increased from Â  Â  Â  134217728 to Â  Â 
Â  268435456 % filled: Â  Â  0.8000hash matrix increased from Â  Â  Â  268435456 to Â  Â  Â  536870912 % filled: Â  Â 
0.8000hash matrix increased from Â  Â  Â  536870912 to Â  Â  Â 1073741824 % filled: Â  Â  0.8000
In the console window I get the following error message:forrtl: severe (157): Program Exception - access violationImage
Â  Â  Â  Â  Â  Â  Â PC Â  Â  Â	Â  Â  Â  Â  Â Routine Â  Â  Â  Â  Â  Â Line Â  Â  Â  Â Source
blupf90.exe Â  Â  Â  Â 000000014011F5F1 Â Unknown Â  Â	Â  Â  Â  Â  Â  Unknown Â Unknownblupf90.exe Â  Â  Â  Â
000000014021A410 Â Unknown Â  Â  Â  Â  Â  Â  Â	Unknown Â Unknownblupf90.exe Â	Â  Â  Â 0000000140219E71 Â Unknown Â  Â
 Â  Â  Â  Â  Â	Unknown Â Unknownblupf90.exe Â	Â  Â  Â 00000001400BB225 Â Unknown Â  Â  Â  Â  Â  Â  Â	Unknown Â
Unknownblupf90.exe Â  Â  Â  Â 0000000140003BAD Â Unknown Â  Â  Â  Â  Â	Â  Â  Unknown Â Unknownblupf90.exe Â  Â  Â  Â
000000014037F6EC Â Unknown Â  Â  Â  Â  Â  Â  Â	Unknown Â Unknownblupf90.exe Â	Â  Â  Â 00000001403637BB Â Unknown Â  Â
 Â  Â  Â  Â  Â	Unknown Â UnknownKERNEL32.DLL Â  Â  Â  00007FFA537613D2 Â Unknown Â  Â	Â  Â  Â  Â  Â  Unknown Â
Unknownntdll.dll Â  Â  Â  Â  Â 00007FFA53B803C4 Â Unknown Â  Â	Â  Â  Â  Â  Â  Unknown Â Unknown


 
 LOG2:*------------------------** Setup Genomic Done !!! **------------------------*
hash matrix increased from Â  Â  Â  Â 33554432 to Â  Â	Â  Â 67108864 % filled: Â  Â  0.8000hash matrix increased from
Â  Â  Â  Â 67108864 to Â  Â  Â	134217728 % filled: Â  Â  0.8000hash matrix increased from Â  Â  Â  134217728 to Â  Â 
Â  268435456 % filled: Â  Â  0.8000hash matrix increased from Â  Â  Â  268435456 to Â  Â  Â  536870912 % filled: Â  Â 
0.8000hash matrix increased from Â  Â  Â  536870912 to Â  Â  Â 1073741824 % filled: Â  Â  0.8000hash matrix increased
from Â	Â  Â 1073741824 to Â  Â  Â 2147483648 % filled: Â  Â  0.8000Â finished peds in Â  Â 2268.594 Â	Â  Â s, Â  Â  Â
 Â  Â  Â  Â 1034579810 Â nonzeroesround = Â  Â	1 Â convergence = Â  Â	Â  Â  NaNround = Â  Â  2 Â convergence = Â  Â 
Â  Â  NaNround = Â  Â  3 Â convergence = Â  Â  Â  Â  NaNround = Â  Â  4 Â convergence = Â  Â  Â  Â  NaN
 

-- 
Andres Legarra
+33 561285182
INRA, UR1388 GenPhySE SAGA
CS 52627
31326 Castanet Tolosan, France 
```

- [582](0582.md): HBLUP with 10 traits by sebmucha, Nov 4, 2015
    - [583](0583.md): Re: [blupf90] HBLUP with 10 traits by Daniela Lourenco, Nov 4, 2015
        - [585](0585.md): Re: [blupf90] HBLUP with 10 traits by sebmucha, Nov 5, 2015
    - [584](0584.md): Re: [blupf90] HBLUP with 10 traits by Andres Legarra, Nov 4, 2015
        - [586](0586.md): Re: [blupf90] HBLUP with 10 traits by sebmucha, Nov 5, 2015
