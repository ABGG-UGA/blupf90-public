## 453: Re: [blupf90] Weird behaviour of gibbs1f90 in model for fitting social interactions

- Title: 453: Re: [blupf90] Weird behaviour of gibbs1f90 in model for fitting social interactions
- Author: Manuel Ramon
- Date: Mar 6, 2015

```
Juan Pablo,Â 
In the first parameter file, random group 8 is a covariate. I think you should put RANDOM GROUP 7 and 29. But I'm not
sure this is your problem, since you got reasonable results with AIREMLF90. In some occasion,Â I have had problems
depending on how the variables are ordered in the data file.


Best


Manuel


On Fri, Mar 6, 2015 at 3:24 PM, 'Sanchez, Juan Pablo' JuanPablo.Sanchez@... [blupf90] <blupf90@yahoogroups.com> wrote:
Â Hi allI am fitting a social interaction model with two different parameter files, but I believe that both should be
equivalent.1.Â Â Â Â Â Â  FIRST PARAMETER FILE:# BLUPF90 parameter file created by RENF90DATAFILEdNUMBER_OF_TRAITSÂ Â Â
Â Â Â Â Â Â Â  1NUMBER_OF_EFFECTSÂ Â  Â Â Â Â Â Â Â 25OBSERVATION(S)Â Â Â  3WEIGHT(S)Â EFFECTS: POSITIONS_IN_DATAFILE
NUMBER_OF_LEVELS TYPE_OF_EFFECT[EFFECT NESTED]Â  8Â Â Â Â Â  33Â Â  crossÂ Â Â	# YS_recÂ  9Â Â Â Â Â  1Â Â Â  covÂ Â Â
Â Â  # EDAD_iniÂ  10Â Â Â Â  1Â Â Â  covÂ Â Â Â Â  # EDAD_endÂ	11Â Â Â Â  5Â Â Â  crossÂ Â Â  # pen_sizeÂ  7Â Â Â Â 
9395Â  crossÂ Â Â  # camadaÂ  6Â Â Â Â	1530Â  crossÂ Â Â  # corralÂ   5Â Â Â  33904Â  crossÂ Â Â  # animalÂ  12Â Â Â Â
Â Â  0Â  crossÂ  13Â Â Â Â Â Â	0Â  crossÂ  14Â Â Â Â Â Â  0Â  crossÂ  15Â Â Â Â Â Â  0Â  crossÂ  16Â Â Â Â Â Â  0Â 
crossÂ	17Â Â Â Â Â Â  0Â  crossÂ  18Â Â Â Â Â Â  0Â  crossÂ  19Â Â Â Â Â Â  0Â  crossÂ  20Â Â Â Â Â Â	0Â  crossÂ  21Â
Â Â Â Â Â  0Â  crossÂ  22Â Â Â Â Â Â  0Â  crossÂ  23Â Â Â Â Â Â  0Â  crossÂ  24Â Â Â Â Â Â  0Â	crossÂ	25Â Â Â Â Â Â 
0Â  crossÂ  26Â Â Â Â Â Â  0Â  crossÂ  27Â Â Â Â Â Â  0Â  crossÂ  28Â Â Â Â Â Â  0Â  crossÂ  29Â Â  33904Â 
crossRANDOM_RESIDUAL VALUESÂ  0.1320E-01RANDOM_GROUPÂ Â Â  5RANDOM_TYPEdiagonalFILEÂ (CO)VARIANCESÂ 
0.1415E-02RANDOM_GROUPÂ Â  6RANDOM_TYPEdiagonalFILEÂ (CO)VARIANCESÂ  0.2758E-01RANDOM_GROUPÂ Â	7
8RANDOM_TYPEadd_animalFILEp(CO)VARIANCESÂ  0.6987E-01Â	0.5648E-01Â  0.5648E-01Â  0.5798E-01Â 2.Â Â Â Â Â Â  SECOND
PARAMETER FILE:Â # BLUPF90 parameter file created by RENF90DATAFILEdNUMBER_OF_TRAITSÂ Â Â Â Â Â Â Â Â Â 
1NUMBER_OF_EFFECTSÂ Â Â Â Â Â Â Â Â  25OBSERVATION(S)Â Â Â  3WEIGHT(S)Â EFFECTS: POSITIONS_IN_DATAFILE NUMBER_OF_LEVELS
TYPE_OF_EFFECT[EFFECT NESTED]Â	8Â Â Â	Â Â 33Â Â  crossÂ Â Â  # YS_recÂ  9Â Â Â Â Â  1Â Â Â  covÂ Â Â Â Â  # EDAD_iniÂ
 10Â Â Â Â  1Â Â Â  covÂ Â Â Â Â  # EDAD_endÂ  11Â Â Â Â  5Â Â Â  crossÂ Â Â  # pen_sizeÂ  7Â Â Â Â  9395Â  crossÂ Â Â 
# camadaÂ  6Â Â Â Â  1530Â  crossÂ Â Â	# corralÂ   12Â Â Â Â Â Â  0Â  crossÂ  13Â Â Â Â Â Â  0Â  crossÂ  14Â Â Â Â Â Â
 0Â  crossÂ  15 Â Â Â Â Â Â 0Â	crossÂ	16Â Â Â Â Â Â  0Â  crossÂ  17Â Â Â Â Â Â  0Â  crossÂ  18Â Â Â Â Â Â  0Â  crossÂ
 19Â Â Â Â Â Â	0Â  crossÂ  20Â Â Â Â Â Â  0Â  crossÂ  21Â Â Â Â Â Â  0Â  crossÂ  22Â Â Â Â Â Â  0Â  crossÂ  23Â Â Â Â
Â Â  0Â  crossÂ  24Â Â Â Â Â Â	0Â  crossÂ  25Â Â Â Â Â Â  0Â  crossÂ  26Â Â Â Â Â Â  0Â  crossÂ  27Â Â Â Â Â Â  0Â 
crossÂ 28Â Â Â Â Â Â  0Â  crossÂ  29Â Â  33904Â  cross5Â Â Â  33904Â  crossÂ Â Â  # animalRANDOM_RESIDUAL VALUESÂ 
0.1320E-01RANDOM_GROUPÂ Â Â  5RANDOM_TYPEdiagonalFILEÂ (CO)VARIANCESÂ  0.1415E-02RANDOM_GROUPÂ Â 
6RANDOM_TYPEdiagonalFILEÂ (CO)VARIANCESÂ  0.2758E-01RANDOM_GROUPÂ Â  24 25RANDOM_TYPEadd_animalFILEp(CO)VARIANCESÂ 
0.6987E-01Â  0.5648E-01Â  0.5648E-01Â  0.5798E-01Â Â With the first implementation (the one indicated in the blupf90
manual) I got this plot for the variance components when using gibbs1f90 (I have just downloaded the binary from the
wiki). What it is happening is that in a given iteration the residual variance became zero, then it is indicated that
it is not positive definitive and them it is corrected.With the second implementation things seems to be OK.Â When I do
the same two implementations using AIREMLf90 both systems of equations seems to be the same.These are Â the MME
information for the first parameter file:Â Â rank=Â Â Â Â Â Â  78508Â YAMS: Yet Another MME SolverÂ  Version
0.9.84--------------------------------------------------------------Original MME:Â Â  No. of EquationsÂ Â Â Â Â Â Â Â Â
Â Â Â Â Â Â  =Â Â Â Â Â  Â Â Â 78773Â Â  No. of NonzerosÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  =Â Â Â Â Â Â  1612316Â Â 
Ordering MethodÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â	=Â Â Â Â Â Â Â Â Â Â  AMDÂ Â  Factor TypeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â
Â Â Â Â Â  =Â Â Â Â Â Â Â Â Â Â  LDLÂ Â  Algorithm for FactorizationÂ Â Â Â  =Â Â Â Â Â Â Â Â  SN LLÂ Â  Algorithm for
InversionÂ Â Â Â Â Â Â Â  =Â Â Â Â Â Â Â Â  INVMFSupernodes (SNs):Â Â  No. of SNs.Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â
Â  =Â Â Â Â Â Â Â Â  36799Â Â  No. of Cols. in the Last SN.Â Â Â  =Â Â Â Â Â Â Â Â  24197Â Â  Frequent No. of Cols.Â Â
Â Â Â Â Â Â Â Â  =Â Â Â Â Â Â Â Â Â Â Â Â  1Â Â  Its CountÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â =Â Â Â Â Â Â Â Â
 21824Â Â  Its Ratio (%)Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  =Â Â Â Â Â  59.30596Â Â  Threshold of SplitÂ Â Â Â Â Â Â Â
Â Â Â Â Â  =Â Â Â  2147483647Factor (L):Â Â  User-defined ConstraintÂ Â Â Â Â Â Â Â  =Â Â Â Â Â Â Â Â Â Â Â Â  0Â Â 
RankÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  =Â Â Â Â Â Â Â Â  78508Â Â  No. of ConstraintsÂ Â Â Â Â Â Â
Â Â Â Â Â Â  =Â Â Â Â Â Â Â Â Â Â  265Â Â  Panel SizeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â	=Â Â Â Â Â Â Â Â Â Â 
256Â Â	Tolerances for Kachman mod.Â Â Â Â  =Â Â Â Â  1.000E-10Â Â Â Â	1.000E-10Â Â  Detection of Panel Size (1:YES)
=Â Â Â Â Â Â Â Â Â Â Â Â  0Memory:Â Â  No. of Effective Entries in LÂ Â  =Â Â Â Â  304604633Â Â  No. of Allocated
Entries in LÂ Â  =Â Â Â Â  310724911Â Â  Storage for LÂ Â Â Â Â Â Â Â Â Â Â Â Â  (MB) =Â Â Â Â Â Â Â  2370.6Â Â 
Storage for Integer Arrays (MB) =Â Â Â Â Â Â Â Â Â  12.0Â Â  Temp. Mem. for FACT.Â Â Â Â Â Â  (MB) =Â Â Â Â Â Â Â Â Â 
16.7Â Â  Temp. Mem. for INV.Â Â Â Â Â Â Â  (MB) =Â Â Â Â Â Â Â Â  470.1CPU & System Time in the last call:Â Â 
OrderingÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  (sec) =Â Â Â Â Â Â Â Â Â Â  2.2Â Â Â Â Â Â Â Â Â Â  2.2Â Â  Symbolic Fact.Â
Â Â Â Â Â Â Â Â Â Â  (sec) =Â Â Â Â Â Â Â Â Â Â  3.0Â Â Â Â Â Â Â Â Â Â  3.1Â Â  Numerical Fact.Â Â Â Â Â Â Â Â Â Â 
(sec) =Â Â Â Â Â Â Â  4758.5Â Â Â Â Â Â Â  1630.1Â Â  Sparse InversionÂ Â Â Â  Â Â Â Â Â (sec) =Â Â Â Â Â Â Â  5396.7Â
Â Â Â Â Â Â  1409.1Â Â	SolutionÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  (sec) =Â Â Â Â Â Â Â Â Â Â  1.0Â Â Â Â Â Â Â Â Â Â 
1.4Â And these are the MME information for the second parameter file.Â rank=Â Â Â Â Â Â  78508Â YAMS: Yet Another MME
SolverÂ  Version 0.9.84--------------------------------------------------------------Original MME:Â Â  No. of
EquationsÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â	=Â Â Â Â  Â Â Â Â 78773Â Â  No. of NonzerosÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  =Â
Â Â Â Â Â  1612316Â Â  Ordering MethodÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  =Â Â Â Â Â Â Â Â Â Â  AMDÂ Â  Factor TypeÂ Â Â Â
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  =Â Â Â Â Â Â Â Â Â Â  LDLÂ Â  Algorithm for FactorizationÂ Â Â Â  =Â Â Â Â Â Â Â Â  SN
LLÂ Â  Algorithm for InversionÂ Â Â Â Â Â Â Â  =Â Â Â Â Â  Â Â Â INVMFSupernodes (SNs):Â Â  No. of SNs.Â Â Â Â Â Â Â Â
Â Â Â Â Â Â Â Â Â Â Â Â  =Â Â Â Â Â Â Â Â  36884Â Â  No. of Cols. in the Last SN.Â Â Â	=Â Â Â Â Â Â Â Â  24262Â Â 
Frequent No. of Cols.Â Â Â Â Â Â Â Â Â Â  =Â Â Â Â Â Â Â Â Â Â Â Â  1Â Â  Its CountÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â
Â Â Â Â  =Â Â Â Â Â Â Â Â  21926Â Â  Its Ratio (%)Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â =Â Â Â Â Â  59.44583Â Â 
Threshold of SplitÂ Â Â Â Â Â Â Â Â Â Â Â Â  =Â Â Â  2147483647Factor (L):Â Â  User-defined ConstraintÂ Â Â Â Â Â Â Â 
=Â Â Â Â Â Â Â Â Â Â Â Â  0Â Â	RankÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  =Â Â Â Â Â Â Â Â  78508Â Â 
No. of ConstraintsÂ Â Â Â Â Â Â Â Â Â Â Â Â  =Â Â Â Â Â Â Â Â Â Â  265Â Â  Panel SizeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â
Â Â Â Â  =Â Â Â Â Â Â Â Â Â Â  256Â Â  Tolerances for Kachman mod.Â Â Â Â  =Â Â Â Â  1.000E-10Â Â Â Â  1.000E-10Â Â 
Detection of Panel Size (1:YES) =Â Â Â Â Â Â Â Â Â Â Â Â  0Memory:Â Â  No. of Effective Entries in LÂ Â  =Â Â Â Â 
305724088Â Â  No. of Allocated Entries in LÂ Â	=Â Â Â Â  310266262Â Â	Storage for LÂ Â Â Â Â Â Â Â Â Â Â Â Â	(MB) =Â
Â Â Â Â Â Â  2367.1Â Â	Storage for Integer Arrays (MB) =Â Â Â Â Â Â Â Â Â  12.6Â Â  Temp. Mem. for FACT.Â Â Â Â Â Â 
(MB) =Â Â Â Â Â Â Â Â Â  11.3Â Â  Temp. Mem. for INV.Â Â Â Â Â Â Â  (MB) =Â Â Â Â Â Â Â Â  495.5CPU & System Time in
the last call:Â Â  OrderingÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  (sec) =Â Â Â Â Â Â Â Â Â Â  2.2Â Â Â Â Â Â Â Â Â Â  2.2Â
Â  Symbolic Fact.Â Â Â Â Â Â Â Â Â Â Â	(sec) =Â Â Â Â Â Â Â Â Â Â  3.2Â Â Â Â Â Â Â Â Â Â  3.2Â Â  Numerical Fact.Â Â
Â Â Â Â Â Â Â Â  (sec) =Â Â Â Â Â Â Â  3864.6Â Â Â Â Â Â Â Â  985.3Â Â	Sparse InversionÂ Â Â Â Â Â Â Â Â  (sec) =Â Â Â
Â Â Â Â  4704.2Â Â Â Â Â Â Â  1137.3Â Â  SolutionÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  (sec) =Â Â Â Â Â Â Â Â Â Â	1.0Â Â
Â Â Â Â Â Â Â Â  1.0Â Â So the question is: What do you think it is going on with the gibbs1f90 program? It seems that
there is something wrong in the creation of the MME in the gibbs1f90 program. Any comment is more than welcome.Best
RegardsJuan PabloÂ Â Â Â Juan Pablo SÃ¡nchez SerranoGenÃ©tica y Mejora AnimalIRTATorre MarimÃ³n, 08140, Caldes de
Montbui, BarcelonaTelf.: 902789449 Ext. 1561Fax : 938650954juanpablo.sanchez@...Â Â 




-- 
Â 
Manuel RamÃ³nm[dot]ramon[dot]fernandez[at]gmail[dot]com

```

- [452](0452.md): Weird behaviour of gibbs1f90 in model for fitting social interactions by Sanchez, Juan Pablo, Mar 6, 2015
    - [453](0453.md): Re: [blupf90] Weird behaviour of gibbs1f90 in model for fitting social interactions by Manuel Ramon, Mar 6, 2015
        - [454](0454.md): Re: [blupf90] Weird behaviour of gibbs1f90 in model for fitting social interactions by Manuel Ramon, Mar 6, 2015
            - [455](0455.md): RE: [blupf90] Weird behaviour of gibbs1f90 in model for fitting social interactions by Sanchez, Juan Pablo, Mar 6, 2015
    - [456](0456.md): RE: [blupf90] Weird behaviour of gibbs1f90 in model for fitting social interactions by Ignacy Misztal, Mar 6, 2015
