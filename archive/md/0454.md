## 454: Re: [blupf90] Weird behaviour of gibbs1f90 in model for fitting social interactions

- Title: 454: Re: [blupf90] Weird behaviour of gibbs1f90 in model for fitting social interactions
- Author: Manuel Ramon
- Date: Mar 6, 2015

```
Sorry, I meant RANDOM GROUP 7 and 25.
Manuel

On Fri, Mar 6, 2015 at 3:40 PM, Manuel Ramon <m.ramon.fernandez@...> wrote:
Juan Pablo,ย 
In the first parameter file, random group 8 is a covariate. I think you should put RANDOM GROUP 7 and 29. But I'm not sure this is your problem, since you got reasonable results with AIREMLF90. In some occasion,ย I have had problems depending on how the variables are ordered in the data file.


Best


Manuel


On Fri, Mar 6, 2015 at 3:24 PM, 'Sanchez, Juan Pablo' JuanPablo.Sanchez@... [blupf90] <blupf90@yahoogroups.com> wrote:
ย Hi allI am fitting a social interaction model with two different parameter files, but I believe that both should be equivalent.1.ย ย ย ย ย ย  FIRST PARAMETER FILE:# BLUPF90 parameter file created by RENF90DATAFILEdNUMBER_OF_TRAITSย ย ย ย ย ย ย ย ย ย  1NUMBER_OF_EFFECTSย ย  ย ย ย ย ย ย ย 25OBSERVATION(S)ย ย ย  3WEIGHT(S)ย EFFECTS: POSITIONS_IN_DATAFILE NUMBER_OF_LEVELS TYPE_OF_EFFECT[EFFECT NESTED]ย  8ย ย ย ย ย  33ย ย  crossย ย ย  # YS_recย  9ย ย ย ย ย  1ย ย ย  covย ย ย ย ย  # EDAD_iniย  10ย ย ย ย  1ย ย ย  covย ย ย ย ย  # EDAD_endย  11ย ย ย ย  5ย ย ย  crossย ย ย  # pen_sizeย  7ย ย ย ย  9395ย  crossย ย ย  # camadaย  6ย ย ย ย  1530ย  crossย ย ย  # corralย   5ย ย ย  33904ย  crossย ย ย  # animalย  12ย ย ย ย ย ย  0ย  crossย  13ย ย ย ย ย ย  0ย  crossย  14ย ย ย ย ย ย  0ย  crossย  15ย ย ย ย ย ย  0ย  crossย  16ย ย ย ย ย ย  0ย  crossย  17ย ย ย ย ย ย  0ย  crossย  18ย ย ย ย ย ย  0ย  crossย  19ย ย ย ย ย ย  0ย  crossย  20ย ย ย ย ย ย  0ย  crossย  21ย ย ย ย ย ย  0ย  crossย  22ย ย ย ย ย ย  0ย  crossย  23ย ย ย ย ย ย  0ย  crossย  24ย ย ย ย ย ย  0ย  crossย  25ย ย ย ย ย ย  0ย  crossย  26ย ย ย ย ย ย  0ย  crossย  27ย ย ย ย ย ย  0ย  crossย  28ย ย ย ย ย ย  0ย  crossย  29ย ย  33904ย  crossRANDOM_RESIDUAL VALUESย  0.1320E-01RANDOM_GROUPย ย ย  5RANDOM_TYPEdiagonalFILEย (CO)VARIANCESย  0.1415E-02RANDOM_GROUPย ย  6RANDOM_TYPEdiagonalFILEย (CO)VARIANCESย  0.2758E-01RANDOM_GROUPย ย  7 8RANDOM_TYPEadd_animalFILEp(CO)VARIANCESย  0.6987E-01ย  0.5648E-01ย  0.5648E-01ย  0.5798E-01ย 2.ย ย ย ย ย ย  SECOND PARAMETER FILE:ย # BLUPF90 parameter file created by RENF90DATAFILEdNUMBER_OF_TRAITSย ย ย ย ย ย ย ย ย ย  1NUMBER_OF_EFFECTSย ย ย ย ย ย ย ย ย  25OBSERVATION(S)ย ย ย  3WEIGHT(S)ย EFFECTS: POSITIONS_IN_DATAFILE NUMBER_OF_LEVELS TYPE_OF_EFFECT[EFFECT NESTED]ย  8ย ย ย  ย ย 33ย ย  crossย ย ย  # YS_recย  9ย ย ย ย ย  1ย ย ย  covย ย ย ย ย  # EDAD_iniย  10ย ย ย ย  1ย ย ย  covย ย ย ย ย  # EDAD_endย  11ย ย ย ย  5ย ย ย  crossย ย ย  # pen_sizeย  7ย ย ย ย  9395ย  crossย ย ย  # camadaย  6ย ย ย ย  1530ย  crossย ย ย  # corralย   12ย ย ย ย ย ย  0ย  crossย  13ย ย ย ย ย ย  0ย  crossย  14ย ย ย ย ย ย  0ย  crossย  15 ย ย ย ย ย ย 0ย  crossย  16ย ย ย ย ย ย  0ย  crossย  17ย ย ย ย ย ย  0ย  crossย  18ย ย ย ย ย ย  0ย  crossย  19ย ย ย ย ย ย  0ย  crossย  20ย ย ย ย ย ย  0ย  crossย  21ย ย ย ย ย ย  0ย  crossย  22ย ย ย ย ย ย  0ย  crossย  23ย ย ย ย ย ย  0ย  crossย  24ย ย ย ย ย ย  0ย  crossย  25ย ย ย ย ย ย  0ย  crossย  26ย ย ย ย ย ย  0ย  crossย  27ย ย ย ย ย ย  0ย  crossย 28ย ย ย ย ย ย  0ย  crossย  29ย ย  33904ย  cross5ย ย ย  33904ย  crossย ย ย  # animalRANDOM_RESIDUAL VALUESย  0.1320E-01RANDOM_GROUPย ย ย  5RANDOM_TYPEdiagonalFILEย (CO)VARIANCESย  0.1415E-02RANDOM_GROUPย ย  6RANDOM_TYPEdiagonalFILEย (CO)VARIANCESย  0.2758E-01RANDOM_GROUPย ย  24 25RANDOM_TYPEadd_animalFILEp(CO)VARIANCESย  0.6987E-01ย  0.5648E-01ย  0.5648E-01ย  0.5798E-01ย ย With the first implementation (the one indicated in the blupf90 manual) I got this plot for the variance components when using gibbs1f90 (I have just downloaded the binary from the wiki). What it is happening is that in a given iteration the residual variance became zero, then it is indicated that it is not positive definitive and them it is corrected.With the second implementation things seems to be OK.ย When I do the same two implementations using AIREMLf90 both systems of equations seems to be the same.These are ย the MME information for the first parameter file:ย ย rank=ย ย ย ย ย ย  78508ย YAMS: Yet Another MME Solverย  Version 0.9.84--------------------------------------------------------------Original MME:ย ย  No. of Equationsย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย  ย ย ย 78773ย ย  No. of Nonzerosย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย  1612316ย ย  Ordering Methodย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย ย ย  AMDย ย  Factor Typeย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย ย ย  LDLย ย  Algorithm for Factorizationย ย ย ย  =ย ย ย ย ย ย ย ย  SN LLย ย  Algorithm for Inversionย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย  INVMFSupernodes (SNs):ย ย  No. of SNs.ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย  36799ย ย  No. of Cols. in the Last SN.ย ย ย  =ย ย ย ย ย ย ย ย  24197ย ย  Frequent No. of Cols.ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย ย ย ย ย  1ย ย  Its Countย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  ย ย =ย ย ย ย ย ย ย ย  21824ย ย  Its Ratio (%)ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย  59.30596ย ย  Threshold of Splitย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย  2147483647Factor (L):ย ย  User-defined Constraintย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย ย ย ย ย  0ย ย  Rankย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย  78508ย ย  No. of Constraintsย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย ย ย  265ย ย  Panel Sizeย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย ย ย  256ย ย  Tolerances for Kachman mod.ย ย ย ย  =ย ย ย ย  1.000E-10ย ย ย ย  1.000E-10ย ย  Detection of Panel Size (1:YES) =ย ย ย ย ย ย ย ย ย ย ย ย  0Memory:ย ย  No. of Effective Entries in Lย ย  =ย ย ย ย  304604633ย ย  No. of Allocated Entries in Lย ย  =ย ย ย ย  310724911ย ย  Storage for Lย ย ย ย ย ย ย ย ย ย ย ย ย  (MB) =ย ย ย ย ย ย ย  2370.6ย ย  Storage for Integer Arrays (MB) =ย ย ย ย ย ย ย ย ย  12.0ย ย  Temp. Mem. for FACT.ย ย ย ย ย ย  (MB) =ย ย ย ย ย ย ย ย ย  16.7ย ย  Temp. Mem. for INV.ย ย ย ย ย ย ย  (MB) =ย ย ย ย ย ย ย ย  470.1CPU & System Time in the last call:ย ย  Orderingย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  (sec) =ย ย ย ย ย ย ย ย ย ย  2.2ย ย ย ย ย ย ย ย ย ย  2.2ย ย  Symbolic Fact.ย ย ย ย ย ย ย ย ย ย ย  (sec) =ย ย ย ย ย ย ย ย ย ย  3.0ย ย ย ย ย ย ย ย ย ย  3.1ย ย  Numerical Fact.ย ย ย ย ย ย ย ย ย ย  (sec) =ย ย ย ย ย ย ย  4758.5ย ย ย ย ย ย ย  1630.1ย ย  Sparse Inversionย ย ย ย  ย ย ย ย ย (sec) =ย ย ย ย ย ย ย  5396.7ย ย ย ย ย ย ย  1409.1ย ย  Solutionย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  (sec) =ย ย ย ย ย ย ย ย ย ย  1.0ย ย ย ย ย ย ย ย ย ย  1.4ย And these are the MME information for the second parameter file.ย rank=ย ย ย ย ย ย  78508ย YAMS: Yet Another MME Solverย  Version 0.9.84--------------------------------------------------------------Original MME:ย ย  No. of Equationsย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย  ย ย ย ย 78773ย ย  No. of Nonzerosย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย  1612316ย ย  Ordering Methodย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย ย ย  AMDย ย  Factor Typeย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย ย ย  LDLย ย  Algorithm for Factorizationย ย ย ย  =ย ย ย ย ย ย ย ย  SN LLย ย  Algorithm for Inversionย ย ย ย ย ย ย ย  =ย ย ย ย ย  ย ย ย INVMFSupernodes (SNs):ย ย  No. of SNs.ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย  36884ย ย  No. of Cols. in the Last SN.ย ย ย  =ย ย ย ย ย ย ย ย  24262ย ย  Frequent No. of Cols.ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย ย ย ย ย  1ย ย  Its Countย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย  21926ย ย  Its Ratio (%)ย ย ย ย ย ย ย  ย ย ย ย ย ย ย ย ย ย ย =ย ย ย ย ย  59.44583ย ย  Threshold of Splitย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย  2147483647Factor (L):ย ย  User-defined Constraintย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย ย ย ย ย  0ย ย  Rankย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย  78508ย ย  No. of Constraintsย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย ย ย  265ย ย  Panel Sizeย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  =ย ย ย ย ย ย ย ย ย ย  256ย ย  Tolerances for Kachman mod.ย ย ย ย  =ย ย ย ย  1.000E-10ย ย ย ย  1.000E-10ย ย  Detection of Panel Size (1:YES) =ย ย ย ย ย ย ย ย ย ย ย ย  0Memory:ย ย  No. of Effective Entries in Lย ย  =ย ย ย ย  305724088ย ย  No. of Allocated Entries in Lย ย  =ย ย ย ย  310266262ย ย  Storage for Lย ย ย ย ย ย ย ย ย ย ย ย ย  (MB) =ย ย ย ย ย ย ย  2367.1ย ย  Storage for Integer Arrays (MB) =ย ย ย ย ย ย ย ย ย  12.6ย ย  Temp. Mem. for FACT.ย ย ย ย ย ย  (MB) =ย ย ย ย ย ย ย ย ย  11.3ย ย  Temp. Mem. for INV.ย ย ย ย ย ย ย  (MB) =ย ย ย ย ย ย ย ย  495.5CPU & System Time in the last call:ย ย  Orderingย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  (sec) =ย ย ย ย ย ย ย ย ย ย  2.2ย ย ย ย ย ย ย ย ย ย  2.2ย ย  Symbolic Fact.ย ย ย ย ย ย ย ย ย ย ย  (sec) =ย ย ย ย ย ย ย ย ย ย  3.2ย ย ย ย ย ย ย ย ย ย  3.2ย ย  Numerical Fact.ย ย ย ย ย ย ย ย ย ย  (sec) =ย ย ย ย ย ย ย  3864.6ย ย ย ย ย ย ย ย  985.3ย ย  Sparse Inversionย ย ย ย ย ย ย ย ย  (sec) =ย ย ย ย ย ย ย  4704.2ย ย ย ย ย ย ย  1137.3ย ย  Solutionย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย  (sec) =ย ย ย ย ย ย ย ย ย ย  1.0ย ย ย ย ย ย ย ย ย ย  1.0ย ย So the question is: What do you think it is going on with the gibbs1f90 program? It seems that there is something wrong in the creation of the MME in the gibbs1f90 program. Any comment is more than welcome.Best RegardsJuan Pabloย ย ย ย Juan Pablo Sรกnchez SerranoGenรฉtica y Mejora AnimalIRTATorre Marimรณn, 08140, Caldes de Montbui, BarcelonaTelf.: 902789449 Ext. 1561Fax : 938650954juanpablo.sanchez@...ย ย 
-- 
ย 
Manuel Ramรณnm[dot]ramon[dot]fernandez[at]gmail[dot]com



 -- 
ย 
Manuel Ramรณnm[dot]ramon[dot]fernandez[at]gmail[dot]com



 
```

- [452](0452.md): Weird behaviour of gibbs1f90 in model for fitting social interactions by Sanchez, Juan Pablo, Mar 6, 2015
    - [453](0453.md): Re: [blupf90] Weird behaviour of gibbs1f90 in model for fitting social interactions by Manuel Ramon, Mar 6, 2015
        - [454](0454.md): Re: [blupf90] Weird behaviour of gibbs1f90 in model for fitting social interactions by Manuel Ramon, Mar 6, 2015
            - [455](0455.md): RE: [blupf90] Weird behaviour of gibbs1f90 in model for fitting social interactions by Sanchez, Juan Pablo, Mar 6, 2015
    - [456](0456.md): RE: [blupf90] Weird behaviour of gibbs1f90 in model for fitting social interactions by Ignacy Misztal, Mar 6, 2015
